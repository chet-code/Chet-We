<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>India Weather App</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    select {
      padding: 10px;
      width: 100%;
      border-radius: 5px;
      border: 1px solid #ddd;
      font-size: 16px;
      margin-bottom: 20px;
    }
    .weather-card {
      text-align: center;
      padding: 20px;
    }
    .city-name {
      font-size: 1.8rem;
      color: #2c3e50;
      margin-bottom: 5px;
    }
    .temperature {
      font-size: 3rem;
      font-weight: bold;
      margin: 10px 0;
      color: #e74c3c;
    }
    .weather-desc {
      font-size: 1.2rem;
      color: #7f8c8d;
      margin-bottom: 20px;
      text-transform: capitalize;
    }
    .details {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-top: 20px;
    }
    .detail-card {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
    }
    .detail-value {
      font-weight: bold;
      font-size: 1.4rem;
      color: #2c3e50;
    }
    .detail-label {
      color: #7f8c8d;
      font-size: 0.9rem;
    }
    .last-updated {
      text-align: center;
      margin-top: 20px;
      color: #95a5a6;
      font-size: 0.8rem;
    }
    .loading {
      text-align: center;
      padding: 40px;
      color: #7f8c8d;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    function WeatherApp() {
      const [weather, setWeather] = useState(null);
      const [loading, setLoading] = useState(true);
      const [city, setCity] = useState("Buldhana");
      const [lastUpdated, setLastUpdated] = useState("");
      
      // Extended city database with Buldhana and other smaller cities
      const cityCoordinates = {
        // Major cities
        "Mumbai": { lat: 19.0760, lon: 72.8777 },
        "Delhi": { lat: 28.6139, lon: 77.2090 },
        "Bangalore": { lat: 12.9716, lon: 77.5946 },
        
        // Smaller cities
        "Buldhana": { lat: 20.5287, lon: 76.1790 },
        "Nashik": { lat: 20.0059, lon: 73.7918 },
        "Nagpur": { lat: 21.1458, lon: 79.0882 },
        "Amravati": { lat: 20.9374, lon: 77.7796 },
        "Aurangabad": { lat: 19.8762, lon: 75.3433 },
        "Kolhapur": { lat: 16.7050, lon: 74.2433 },
        "Solapur": { lat: 17.6599, lon: 75.9064 },
        "Pune": { lat: 18.5204, lon: 73.8567 },
        
        // Hill stations
        "Mahabaleshwar": { lat: 17.9239, lon: 73.6585 },
        "Lonavala": { lat: 18.7500, lon: 73.4167 },
        "Matheran": { lat: 18.9858, lon: 73.2713 }
      };

      const getWeatherDescription = (code) => {
        const weatherMap = {
          0: "Clear sky",
          1: "Mainly clear",
          2: "Partly cloudy",
          3: "Overcast",
          45: "Fog",
          48: "Fog with rime",
          51: "Light drizzle",
          53: "Moderate drizzle",
          55: "Dense drizzle",
          56: "Light freezing drizzle",
          57: "Dense freezing drizzle",
          61: "Light rain",
          63: "Moderate rain",
          65: "Heavy rain",
          66: "Light freezing rain",
          67: "Heavy freezing rain",
          71: "Light snow",
          73: "Moderate snow",
          75: "Heavy snow",
          77: "Snow grains",
          80: "Light rain showers",
          81: "Moderate rain showers",
          82: "Violent rain showers",
          85: "Light snow showers",
          86: "Heavy snow showers",
          95: "Thunderstorm",
          96: "Thunderstorm with hail",
          99: "Severe thunderstorm"
        };
        return weatherMap[code] || "Unknown weather";
      };

      useEffect(() => {
        const fetchWeather = async () => {
          setLoading(true);
          try {
            const { lat, lon } = cityCoordinates[city] || cityCoordinates["Buldhana"];
            const response = await fetch(
              `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,weather_code,wind_speed_10m,apparent_temperature&timezone=auto`
            );
            const data = await response.json();
            
            setWeather({
              temp: data.current.temperature_2m,
              feels_like: data.current.apparent_temperature,
              humidity: data.current.relative_humidity_2m,
              wind: data.current.wind_speed_10m,
              weather_code: data.current.weather_code,
              description: getWeatherDescription(data.current.weather_code)
            });
            
            setLastUpdated(new Date().toLocaleTimeString());
          } catch (error) {
            console.error("Error fetching weather:", error);
          } finally {
            setLoading(false);
          }
        };

        fetchWeather();
        const interval = setInterval(fetchWeather, 600000); // Update every 10 mins
        return () => clearInterval(interval);
      }, [city]);

      if (loading) {
        return (
          <div className="container">
            <div className="loading">
              <h2>Loading weather data for {city}...</h2>
              <p>Please wait</p>
            </div>
          </div>
        );
      }

      return (
        <div className="container">
          <h1 style={{textAlign: 'center', color: '#2c3e50', marginBottom: '10px'}}>
            Maharashtra Weather
          </h1>
          
          <select 
            value={city} 
            onChange={(e) => setCity(e.target.value)}
          >
            {Object.keys(cityCoordinates)
              .sort()
              .map(city => (
                <option key={city} value={city}>{city}</option>
              ))
            }
          </select>

          {weather && (
            <div className="weather-card">
              <h2 className="city-name">{city}</h2>
              <div className="temperature">{Math.round(weather.temp)}°C</div>
              <div className="weather-desc">{weather.description}</div>
              
              <div className="details">
                <div className="detail-card">
                  <div className="detail-value">{Math.round(weather.feels_like)}°C</div>
                  <div className="detail-label">Feels Like</div>
                </div>
                <div className="detail-card">
                  <div className="detail-value">{weather.humidity}%</div>
                  <div className="detail-label">Humidity</div>
                </div>
                <div className="detail-card">
                  <div className="detail-value">{Math.round(weather.wind)} km/h</div>
                  <div className="detail-label">Wind Speed</div>
                </div>
                <div className="detail-card">
                  <div className="detail-value">
                    {weather.weather_code <= 3 ? "☀️" : 
                     weather.weather_code <= 48 ? "🌫️" : 
                     weather.weather_code <= 67 ? "🌧️" : 
                     weather.weather_code <= 86 ? "❄️" : "⛈️"}
                  </div>
                  <div className="detail-label">Conditions</div>
                </div>
              </div>
              
              <p className="last-updated">
                Last updated: {lastUpdated}
              </p>
            </div>
          )}
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<WeatherApp />);
  </script>
</body>
</html>
