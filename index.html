<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>India Weather App</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f8faf8;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
      color: #2d3748;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }
    h1, h2, h3 {
      color: #2f855a;
    }
    select {
      width: 100%;
      padding: 12px;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      font-size: 16px;
      margin: 10px 0;
      background: white;
      color: #4a5568;
    }
    .weather-header {
      text-align: center;
      margin-bottom: 20px;
    }
    .current-weather {
      background: #f0fff4;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 25px;
    }
    .temp-display {
      font-size: 3.5rem;
      font-weight: 300;
      color: #2f855a;
      margin: 10px 0;
    }
    .weather-desc {
      font-size: 1.2rem;
      color: #4a5568;
      margin-bottom: 15px;
    }
    .detail-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-top: 20px;
    }
    .detail-card {
      background: white;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .forecast-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 12px;
      margin-top: 25px;
    }
    .forecast-day {
      background: white;
      padding: 12px;
      border-radius: 8px;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .hourly-forecast {
      display: flex;
      overflow-x: auto;
      gap: 10px;
      padding: 15px 0;
      margin-top: 20px;
    }
    .hour-card {
      min-width: 70px;
      background: white;
      padding: 12px;
      border-radius: 8px;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .hour-time {
      font-weight: 600;
      color: #2f855a;
      margin-bottom: 5px;
    }
    .hour-temp {
      font-size: 1.1rem;
      color: #4a5568;
    }
    .day-name {
      font-weight: 600;
      color: #2f855a;
      margin-bottom: 8px;
    }
    .forecast-temp {
      font-size: 1.1rem;
      color: #4a5568;
    }
    .last-updated {
      text-align: center;
      margin-top: 25px;
      color: #718096;
      font-size: 0.9rem;
    }
    .loading {
      text-align: center;
      padding: 40px;
      color: #718096;
    }
    .location-selectors {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 20px;
    }
    .tab-container {
      display: flex;
      margin-top: 20px;
      border-bottom: 1px solid #e2e8f0;
    }
    .tab {
      padding: 10px 20px;
      cursor: pointer;
      border-bottom: 2px solid transparent;
    }
    .tab.active {
      border-bottom: 2px solid #2f855a;
      color: #2f855a;
      font-weight: 600;
    }
    @media (max-width: 600px) {
      .location-selectors {
        grid-template-columns: 1fr;
      }
      .detail-grid {
        grid-template-columns: 1fr 1fr;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    function WeatherApp() {
      const [weather, setWeather] = useState(null);
      const [forecast, setForecast] = useState(null);
      const [hourlyData, setHourlyData] = useState(null);
      const [loading, setLoading] = useState(true);
      const [selectedState, setSelectedState] = useState("Maharashtra");
      const [selectedCity, setSelectedCity] = useState("Buldhana");
      const [lastUpdated, setLastUpdated] = useState("");
      const [activeTab, setActiveTab] = useState("daily");

      const indiaCities = {
        "Maharashtra": {
          "Mumbai": { lat: 19.0760, lon: 72.8777 },
          "Pune": { lat: 18.5204, lon: 73.8567 },
          "Nagpur": { lat: 21.1458, lon: 79.0882 },
          "Buldhana": { lat: 20.5287, lon: 76.1790 },
          "Nashik": { lat: 20.0059, lon: 73.7918 },
          "Aurangabad": { lat: 19.8762, lon: 75.3433 },
          "Kolhapur": { lat: 16.7050, lon: 74.2433 }
        },
        "Karnataka": {
          "Bangalore": { lat: 12.9716, lon: 77.5946 },
          "Mysore": { lat: 12.2958, lon: 76.6394 },
          "Hubli": { lat: 15.3647, lon: 75.1240 }
        },
        "Tamil Nadu": {
          "Chennai": { lat: 13.0827, lon: 80.2707 },
          "Coimbatore": { lat: 11.0168, lon: 76.9558 }
        }
      };

      const getWeatherIcon = (code) => {
        const icons = {
          0: "â˜€ï¸", 1: "ðŸŒ¤ï¸", 2: "â›…", 3: "â˜ï¸",
          45: "ðŸŒ«ï¸", 48: "ðŸŒ«ï¸", 51: "ðŸŒ¦ï¸", 53: "ðŸŒ§ï¸",
          55: "ðŸŒ§ï¸", 56: "ðŸŒ§ï¸â„ï¸", 57: "ðŸŒ§ï¸â„ï¸", 61: "ðŸŒ§ï¸",
          63: "ðŸŒ§ï¸", 65: "ðŸŒ§ï¸", 66: "ðŸŒ§ï¸â„ï¸", 67: "ðŸŒ§ï¸â„ï¸",
          80: "ðŸŒ¦ï¸", 81: "ðŸŒ§ï¸", 82: "ðŸŒ§ï¸", 95: "â›ˆï¸",
          96: "â›ˆï¸", 99: "â›ˆï¸"
        };
        return icons[code] || "ðŸŒˆ";
      };

      const getDayName = (dateStr) => {
        const date = new Date(dateStr);
        return date.toLocaleDateString('en-US', { weekday: 'short' });
      };

      const formatTime = (timeStr) => {
        const date = new Date(timeStr);
        return date.toLocaleTimeString('en-US', { hour: 'numeric', hour12: true });
      };

      useEffect(() => {
        const fetchWeather = async () => {
          setLoading(true);
          try {
            const { lat, lon } = indiaCities[selectedState][selectedCity] || 
                              indiaCities["Maharashtra"]["Buldhana"];
            
            // Fetch current weather, daily forecast, and hourly data
            const response = await fetch(
              `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,weather_code,wind_speed_10m&daily=weather_code,temperature_2m_max,temperature_2m_min&hourly=temperature_2m,weather_code&timezone=auto`
            );
            const data = await response.json();
            
            // Process current weather
            setWeather({
              temp: data.current.temperature_2m,
              humidity: data.current.relative_humidity_2m,
              wind: data.current.wind_speed_10m,
              weather_code: data.current.weather_code,
              icon: getWeatherIcon(data.current.weather_code)
            });
            
            // Process 7-day forecast
            const dailyForecast = data.daily.time.map((day, index) => ({
              date: day,
              day: getDayName(day),
              max_temp: data.daily.temperature_2m_max[index],
              min_temp: data.daily.temperature_2m_min[index],
              weather_code: data.daily.weather_code[index],
              icon: getWeatherIcon(data.daily.weather_code[index])
            }));
            setForecast(dailyForecast.slice(0, 7));
            
            // Process hourly data (next 24 hours)
            const now = new Date();
            const hourlyForecast = data.hourly.time
              .map((time, index) => ({
                time,
                hour: formatTime(time),
                temp: data.hourly.temperature_2m[index],
                weather_code: data.hourly.weather_code[index],
                icon: getWeatherIcon(data.hourly.weather_code[index])
              }))
              .filter(hour => new Date(hour.time) > now)
              .slice(0, 24);
            setHourlyData(hourlyForecast);
            
            setLastUpdated(new Date().toLocaleTimeString());
          } catch (error) {
            console.error("Error fetching weather:", error);
          } finally {
            setLoading(false);
          }
        };

        fetchWeather();
        const interval = setInterval(fetchWeather, 600000); // Update every 10 mins
        return () => clearInterval(interval);
      }, [selectedState, selectedCity]);

      if (loading) {
        return (
          <div className="container">
            <div className="loading">
              <h2>Loading weather data...</h2>
              <p>Please wait while we fetch the latest information</p>
            </div>
          </div>
        );
      }

      return (
        <div className="container">
          <div className="weather-header">
            <h1>India Weather Forecast</h1>
            <p>Time-wise weather updates in clean green/white design</p>
          </div>
          
          <div className="location-selectors">
            <div>
              <label htmlFor="state-select">State</label>
              <select 
                id="state-select"
                value={selectedState} 
                onChange={(e) => {
                  setSelectedState(e.target.value);
                  setSelectedCity(Object.keys(indiaCities[e.target.value])[0]);
                }}
              >
                {Object.keys(indiaCities).map(state => (
                  <option key={state} value={state}>{state}</option>
                ))}
              </select>
            </div>
            
            <div>
              <label htmlFor="city-select">City/Town</label>
              <select 
                id="city-select"
                value={selectedCity} 
                onChange={(e) => setSelectedCity(e.target.value)}
              >
                {Object.keys(indiaCities[selectedState] || {}).map(city => (
                  <option key={city} value={city}>{city}</option>
                ))}
              </select>
            </div>
          </div>

          {weather && (
            <div className="current-weather">
              <h2>{selectedCity}, {selectedState}</h2>
              <div style={{display: 'flex', alignItems: 'center', justifyContent: 'center'}}>
                <span style={{fontSize: '3rem', marginRight: '15px'}}>{weather.icon}</span>
                <div>
                  <div className="temp-display">{Math.round(weather.temp)}Â°C</div>
                  <div className="weather-desc">
                    {weather.icon} {getWeatherDescription(weather.weather_code)}
                  </div>
                </div>
              </div>
              
              <div className="detail-grid">
                <div className="detail-card">
                  <div style={{fontSize: '1.4rem'}}>ðŸ’§</div>
                  <div>Humidity</div>
                  <div className="detail-value">{weather.humidity}%</div>
                </div>
                <div className="detail-card">
                  <div style={{fontSize: '1.4rem'}}>ðŸ’¨</div>
                  <div>Wind Speed</div>
                  <div className="detail-value">{Math.round(weather.wind)} km/h</div>
                </div>
                <div className="detail-card">
                  <div style={{fontSize: '1.4rem'}}>ðŸ•’</div>
                  <div>Last Updated</div>
                  <div className="detail-value">{lastUpdated}</div>
                </div>
              </div>
            </div>
          )}

          <div className="tab-container">
            <div 
              className={`tab ${activeTab === 'daily' ? 'active' : ''}`}
              onClick={() => setActiveTab('daily')}
            >
              7-Day Forecast
            </div>
            <div 
              className={`tab ${activeTab === 'hourly' ? 'active' : ''}`}
              onClick={() => setActiveTab('hourly')}
            >
              Hourly Forecast
            </div>
          </div>

          {activeTab === 'daily' && forecast && (
            <div className="forecast-container">
              {forecast.map((day, index) => (
                <div className="forecast-day" key={day.date}>
                  <div className="day-name">{index === 0 ? 'Today' : day.day}</div>
                  <div style={{fontSize: '1.5rem', margin: '5px 0'}}>{day.icon}</div>
                  <div className="forecast-temp">
                    <span style={{fontWeight: '600'}}>{Math.round(day.max_temp)}Â°</span> / {Math.round(day.min_temp)}Â°
                  </div>
                </div>
              ))}
            </div>
          )}

          {activeTab === 'hourly' && hourlyData && (
            <div>
              <h3>Next 24 Hours</h3>
              <div className="hourly-forecast">
                {hourlyData.map((hour, index) => (
                  <div className="hour-card" key={index}>
                    <div className="hour-time">{hour.hour}</div>
                    <div style={{fontSize: '1.5rem', margin: '5px 0'}}>{hour.icon}</div>
                    <div className="hour-temp">{Math.round(hour.temp)}Â°</div>
                  </div>
                ))}
              </div>
            </div>
          )}
          
          <div className="last-updated">
            Data updates automatically every 10 minutes
          </div>
        </div>
      );
    }

    function getWeatherDescription(code) {
      const weatherMap = {
        0: "Clear sky", 1: "Mainly clear", 2: "Partly cloudy", 3: "Overcast",
        45: "Fog", 48: "Fog", 51: "Light drizzle", 53: "Moderate drizzle",
        55: "Dense drizzle", 56: "Freezing drizzle", 57: "Freezing drizzle",
        61: "Light rain", 63: "Moderate rain", 65: "Heavy rain",
        80: "Light showers", 81: "Moderate showers", 82: "Violent showers",
        95: "Thunderstorm", 96: "Thunderstorm", 99: "Thunderstorm"
      };
      return weatherMap[code] || "";
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<WeatherApp />);
  </script>
</body>
</html>
